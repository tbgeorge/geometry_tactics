//=================================================================================
// Cell.hpp
// Author: Tyler George
// Date  : October 28, 2015
//=================================================================================

#pragma once

#ifndef __included_Cell__
#define __included_Cell__

///---------------------------------------------------------------------------------
/// Includes
///---------------------------------------------------------------------------------
#include "GameCode/GameCommon.hpp"
#include "Engine/Input/InputSystem.hpp"
#include "Engine/Renderer/OpenGLRenderer.hpp"
#include "GameCode/Entities/Feature.hpp"

class Actor;

///---------------------------------------------------------------------------------
/// Constants
///---------------------------------------------------------------------------------
const float CELL_SIZE = 1.0f;

///---------------------------------------------------------------------------------
/// Typedefs
///---------------------------------------------------------------------------------


////===========================================================================================
///===========================================================================================
// Cell Class
///===========================================================================================
////===========================================================================================
class Cell
{
public:
    ///---------------------------------------------------------------------------------
    /// Constructors/Destructors
    ///---------------------------------------------------------------------------------
    Cell();
    Cell( const MapPosition& mapPos, float height );
    ~Cell();

    ///---------------------------------------------------------------------------------
    /// Initialization
    ///---------------------------------------------------------------------------------
    void Startup();

    ///---------------------------------------------------------------------------------
    /// Accessors/Queries
    ///---------------------------------------------------------------------------------
    float GetHeight() { return m_height; }
    float GetRealHeight();
    Actor* GetActor() { return m_actor; }
    Feature* GetFeature() { return m_feature; }
    MapPosition GetMapPosition() { return m_mapPos; }
    bool IsHovered() { return m_isHovered; }

    ///---------------------------------------------------------------------------------
    /// Mutators
    ///---------------------------------------------------------------------------------
    void CalculateVertexes( PUC_Vertexes& verts, std::vector< unsigned int >& indexes, int indexOffset );
    void SetHovered( bool isHovered );
    void SetActor( Actor* actor ) { m_actor = actor; }
    void SetFeature( Feature* feature ) { m_feature = feature; }

	///---------------------------------------------------------------------------------
	/// Update
	///---------------------------------------------------------------------------------
    void ProcessInput( InputSystem* inputSystem, double deltaSeconds );
    void Update( double deltaSeconds, bool debugModeEnabled );

	///---------------------------------------------------------------------------------
	/// Render
	///---------------------------------------------------------------------------------
    void Render( OpenGLRenderer* renderer, bool debugModeEnabled );

	///---------------------------------------------------------------------------------
	/// Public Member Variables
	///---------------------------------------------------------------------------------

	///---------------------------------------------------------------------------------
	/// Static Variables
	///---------------------------------------------------------------------------------


private:
	///---------------------------------------------------------------------------------
	/// Private Functions
	///---------------------------------------------------------------------------------

	///---------------------------------------------------------------------------------
	/// Private Member Variables
	///---------------------------------------------------------------------------------
    MapPosition m_mapPos;
    float m_height;

    bool m_isHovered;

    Actor* m_actor;

    Feature* m_feature;

};

typedef std::map< MapPosition, Cell > CellMap;

///---------------------------------------------------------------------------------
/// Inline function implementations
///---------------------------------------------------------------------------------

#endif